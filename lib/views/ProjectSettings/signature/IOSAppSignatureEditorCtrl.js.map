{"version":3,"file":"IOSAppSignatureEditorCtrl.js","sourceRoot":"","sources":["../../../../src/views/ProjectSettings/signature/IOSAppSignatureEditorCtrl.ts"],"names":[],"mappings":"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","sourcesContent":["'use babel'\n\n/*!\n * Dynamic Engine Workbench\n * Copyright(c) 2017 Dynamic Engine Team @ Vipera Plc\n * MIT Licensed\n */\n import {\n  createText,\n  createElement,\n  insertElement,\n  createGroupButtons,\n  createButton,\n  createIcon,\n  createIconFromPath,\n  attachEventFromObject,\n  createTextEditor\n } from '../../../element/index';\n\nimport { EventEmitter }  from 'events'\nimport { Logger } from '../../../logger/Logger'\nimport { UIComponent, UIBaseComponent } from '../../../ui-components/UIComponent'\nimport { UISelect, UISelectItem, UISelectListener } from '../../../ui-components/UISelect'\nimport { UIInputFormElement, UISelectFormElement } from '../../../ui-components/UIInputFormElement'\nimport { AbstractAppSignatureEditorCtrl, AppType } from './AbstractAppSignatureEditorCtrl'\nimport { IOSUtilities } from '../../../cordova/IOSUtilities'\nimport { UIButtonMenu } from '../../../ui-components/UIButtonMenu'\n\nconst _  = require('lodash')\n\nexport class IOSAppSignatureEditorCtrl extends AbstractAppSignatureEditorCtrl  {\n\n  private packageTypeSelect:UISelectFormElement;\n  private devTeamInput:UIInputFormElement;\n  private provisioningProfileInput:UIInputFormElement;\n  private btnProvisioningProfilesSelector: UIButtonMenu;\n  private codeSignIdentityInput:UIInputFormElement;\n  private provisioningProfiles:any;\n\n  constructor(appType:AppType){\n    super(appType);\n  }\n\n  protected createControls():Array<HTMLElement> {\n    this.devTeamInput = new UIInputFormElement().setCaption('Development Team').setPlaceholder('Development Team').addEventListener('change',(evtCtrl:UIInputFormElement)=>{\n    });\n    this.codeSignIdentityInput = new UIInputFormElement().setCaption('Code Sign Identity').setPlaceholder('Code Sign Identity').addEventListener('change',(evtCtrl:UIInputFormElement)=>{\n    });\n    this.provisioningProfileInput = new UIInputFormElement().setCaption('Provisioning Profile ID').setPlaceholder('Provisioning Profile ID').addEventListener('change',(evtCtrl:UIInputFormElement)=>{\n    }).setExtClassName('control-group-with-button');\n\n    // ============================================================================\n    // Provisioning Profile Selector Button\n    this.btnProvisioningProfilesSelector = new UIButtonMenu()\n                                      .setCaption('Select from list...')\n                                      .setInfoMessage('Select a Provisioning Profile')\n                                      .setEmptyMessage('  NOTE: Loading Provisioning Profiles...')\n                                      .setOnSelectionListener((menuItem)=>{\n                                        this.provisioningProfileInput.setValue(menuItem.value);\n                                        this.devTeamInput.setValue(menuItem.userData.teamIdentifier[0]);\n                                      });\n    let btnProvisioningProfilesSelectorDiv = createElement('div',{\n      elements: [\n        this.btnProvisioningProfilesSelector.element()\n      ],\n      className: 'select-provisioning-profile-ctrl'\n    });\n\n    this.btnProvisioningProfilesSelector.setMenuItems([]);\n    this.provisioningProfileInput.element().appendChild(btnProvisioningProfilesSelectorDiv);\n    // ============================================================================\n\n    this.packageTypeSelect = new UISelectFormElement().setCaption('Package Type');\n    this.packageTypeSelect.setItems(this.getPackageTypeItems());\n\n    return [this.provisioningProfileInput.element(), this.devTeamInput.element(), this.codeSignIdentityInput.element(), this.packageTypeSelect.element()];\n  }\n\n  onItemSelected(value) {\n    let provisioningProfile = this.getprovisionigProfileByUUID(value);\n    //alert(provisioningProfile.teamName);\n    this.devTeamInput.setValue(provisioningProfile.teamIdentifier[0]);\n    this.devTeamInput.setCaption(\"Development Team [\" + provisioningProfile.teamName +\"]\");\n  }\n\n  private getprovisionigProfileByUUID(uuid:string):any {\n    return _.find(this.provisioningProfiles, (obj)=>{\n      return obj.data.UUID === uuid;\n    });\n  }\n\n  private getProvisioningProfileByAppId(appId:string):any {\n    return this.provisioningProfiles[appId];\n  }\n\n  protected getPackageTypeItems():Array<UISelectItem>{\n    return [\n        { value: \"developement\",\n          name: \"Developement\"\n        },\n        { value: \"adhoc\",\n          name: \"Ad-Hoc\"\n        },\n        { value: \"enterprise\",\n          name: \"Enterprise\"\n        },\n        { value: \"appstore\",\n          name: \"AppStore\"\n        }\n    ]\n  }\n\n  public destroy(){\n    this.packageTypeSelect.destroy();\n    this.devTeamInput.destroy();\n    this.codeSignIdentityInput.destroy();\n    super.destroy();\n  }\n\n  public reloadProvisioningProfiles(provisioningProfiles:any){\n    this.btnProvisioningProfilesSelector.setEmptyMessage(\"  NOTE: No provisioning profiles found\");\n    let values = _.map(provisioningProfiles, (profile)=>{\n        return {\n          displayName: profile.data.AppIDName,\n          value: profile.data.UUID,\n          userData: profile\n        }\n    });\n    var sortedValues = _.sortBy(values, (item)=>{\n      return item.displayName;\n    });\n    this.btnProvisioningProfilesSelector.setMenuItems(sortedValues);\n  }\n\n  protected refreshProvisioningSelected(toSelect:string){\n    alert(\"TODO!! refreshProvisioningSelected\")\n    if (toSelect){\n      //this.provisioningProfileSelect.setValue(toSelect)\n    } else {\n      // get saved\n      let json = this.getBuildJsonsection('ios');\n      if (json){\n        //this.provisioningProfileSelect.setValue(json.provisioningProfile)\n      }\n    }\n  }\n\n  protected createItems(provisioningProfiles:any):Array<UISelectItem> {\n    let ret = _.map(provisioningProfiles, (item)=>{\n        return {\n          name: item.data.AppIDName,\n          value: item.data.UUID,\n          userData: item\n        }\n    });\n    var sortedCollection = _.sortBy(ret, (item)=>{\n      return item.name;\n    });\n    return sortedCollection;\n  }\n\n  public updateUI(buildJson:any){\n    let json = this.getBuildJsonsection('ios');\n    if (json){\n      this.provisioningProfileInput.setValue(json.provisioningProfile)\n      this.codeSignIdentityInput.setValue(json.codeSignIdentity)\n      this.devTeamInput.setValue(json.developmentTeam)\n      this.packageTypeSelect.setValue(json.packageType)\n    }\n  }\n\n  public saveChanges(){\n    let json = this.getBuildJsonsection('ios');\n    if (json){\n      json.provisioningProfile = this.provisioningProfileInput.getValue()\n      json.codeSignIdentity = this.codeSignIdentityInput.getValue()\n      json.developmentTeam = this.devTeamInput.getValue()\n      json.packageType = this.packageTypeSelect.getValue()\n    }\n  }\n\n  public async reload(){\n    this.updateUI(this.buildJson);\n  }\n\n\n}\n"]}