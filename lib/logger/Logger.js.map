{"version":3,"file":"Logger.js","sourceRoot":"","sources":["../../src/logger/Logger.ts"],"names":[],"mappings":"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","sourcesContent":["'use babel'\n\n/*!\n * Dynamic Engine Workbench\n * Copyright(c) 2017 Dynamic Engine Team @ Vipera Plc\n * MIT Licensed\n */\n\n var winston = require('winston');\nimport {EventSupport,EventSupportDelegate} from '../utils/EventSupport'\nimport { GlobalPreferences } from '../DEWorkbench/GlobalPreferences'\n\nconst path = require(\"path\")\n\nexport class Logger {\n\n  public static CONSOLE_LOG_ENABLED: boolean = false; //enable for debug purpose\n\n  private static instance: Logger;\n\n  private logger: any;\n  private evtSupport:EventSupport;\n\n\n  private constructor(){\n    let filePath = path.join(GlobalPreferences.preferencesFolder, 'de_workbench.log')\n    let filePathJSON = path.join(GlobalPreferences.preferencesFolder, 'de_workbench_json.log')\n    this.logger = new (winston.Logger)({\n      transports: [\n        new winston.transports.File({\n            level: 'debug',\n            filename: filePath,\n            handleExceptions: true,\n            json: false,\n            maxsize: 5242880, //5MB\n            maxFiles: 5,\n            colorize: false\n        }),\n        new winston.transports.File({\n            level: 'debug',\n            name: 'log-buffer',\n            filename: filePathJSON,\n            handleExceptions: true,\n            json: true,\n            maxsize: 5242880, //5MB\n            maxFiles: 5,\n            colorize: false\n        })\n      ]\n    });\n    this.evtSupport = new EventSupport();\n  }\n\n  static getInstance() {\n      if (!Logger.instance) {\n          Logger.instance = new Logger();\n      }\n      return Logger.instance;\n  }\n\n  static getLoggerBufferFilePath(){\n    return path.join(GlobalPreferences.preferencesFolder, 'de_workbench_json.log');\n  }\n\n  info(...msg:any[]){\n    this.fireLogEvent(LogLevel.INFO,msg);\n    this.logger.info.apply(this, msg);\n    Logger.consoleLog(\"\", msg);\n  }\n\n  debug(...msg:any[]){\n    this.fireLogEvent(LogLevel.DEBUG,msg);\n    this.logger.debug.apply(this, msg);\n    Logger.consoleLog(\"\", msg);\n  }\n\n  warn(...msg:any[]){\n    this.fireLogEvent(LogLevel.WARN,msg);\n    this.logger.warn.apply(this, msg);\n    Logger.consoleLog(\"\",msg);\n  }\n\n  error(...msg:any[]){\n    this.fireLogEvent(LogLevel.ERROR,msg);\n    this.logger.error.apply(this, msg);\n    Logger.consoleLog(\"\", msg);\n  }\n\n\n\n  private fireLogEvent(level:LogLevel,...msg){\n    this.evtSupport.fireEvent('logging',level,msg.join(' , '));\n  }\n\n  addLoggingListener(listener:LoggerListener):void{\n    this.evtSupport.addEventListener((event:string,data:any[]) => {\n      listener.onLogging(data[0],data[1]);\n    });\n  }\n\n\n  public static consoleLog(msg:string,...params){\n    if (!Logger.CONSOLE_LOG_ENABLED){\n      return;\n    }\n    if (params && params.length>0){\n      console.log(msg, params);\n    } else {\n      console.log(msg);\n    }\n  }\n\n}\n\nexport interface LoggerListener{\n  onLogging(level:LogLevel, msg:string);\n}\n\nexport enum LogLevel {\n  'TRACE',\n  'DEBUG',\n  'INFO',\n  'WARN',\n  'ERROR',\n}\n"]}