{"version":3,"file":"UITreeView.js","sourceRoot":"","sources":["../../src/ui-components/UITreeView.ts"],"names":[],"mappings":"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","sourcesContent":["'use babel'\n\n/*!\n * Dynamic Engine Workbench\n * Copyright(c) 2017 Dynamic Engine Team @ Vipera Plc\n * MIT Licensed\n */\n import {\n   createText,\n   createElement,\n   insertElement,\n   createGroupButtons,\n   createButton,\n   createIcon,\n   createIconFromPath,\n   attachEventFromObject,\n   createTextEditor\n } from '../element/index';\n\nimport { UIComponent, UIBaseComponent } from './UIComponent'\nimport { forEach, remove } from 'lodash'\nimport { EventEmitter }  from 'events'\nconst $ = require(\"jquery\")\n\nexport interface UITreeItemAttribute {\n  name:string;\n  value:string;\n}\n\nexport interface UITreeItem {\n  id:string;\n  name:string;\n  className?:string;\n  icon?:string;\n  expanded?:boolean;\n  htmlElement?:HTMLElement;\n  children?:Array<UITreeItem>;\n  selected?:boolean;\n  attributes?:Array<UITreeItemAttribute>\n}\n\nexport interface UITreeViewModel {\n  root:UITreeItem;\n  className?:string;\n  getItemById(id:string):UITreeItem; // optional, if provided, listeners receive both id and item of selection\n  addEventListener(event:string, listener);\n  removeEventListener(event:string, listener);\n  destroy();\n}\n\nexport interface UITreeViewSelectListener {\n  onItemSelected(itemId:string,item?:UITreeItem):void\n}\n\nexport class UITreeView extends UIBaseComponent {\n\n  private model:UITreeViewModel;\n  private treeElement: HTMLElement;\n  private currentSelection: string;\n  private events:EventEmitter;\n\n  constructor(model?:UITreeViewModel){\n    super();\n    this.events = new EventEmitter();\n    this.initUI();\n    if (model){\n      this.setModel(model);\n    }\n  }\n\n  private initUI(){\n    this.mainElement =  createElement('div', {\n        elements: [\n              ],\n        className:'de-workbench-treeview' // do not use this class in order to avoid key bindings problems: 'tree-view'\n    })\n\n  }\n\n  public setModel(model:UITreeViewModel){\n    this.model = model;\n    this.onModelChanged()\n    this.model.addEventListener('didModelChanged',()=>{\n      this.onModelChanged();\n    })\n  }\n\n  protected onModelChanged(){\n    let oldTree = this.treeElement;\n    this.treeElement = this.rebuildTree();\n    if (oldTree){\n      this.mainElement.replaceChild(this.treeElement, oldTree);\n    } else {\n      insertElement(this.mainElement, this.treeElement)\n    }\n    this.currentSelection = null;\n    this.events.emit(\"didModelChanged\", this)\n  }\n\n  private rebuildTree():HTMLElement {\n\n    let rootItemEl = this.buildTreeItem(this.model.root);\n\n    let ulMainTree = createElement('ul',{\n        elements : [ rootItemEl ],\n        className: 'list-tree has-collapsable-children focusable-panel'\n    })\n\n    return ulMainTree;\n  }\n\n  private buildTreeItem(item:UITreeItem){\n\n    let iconClass = \"\";\n    if (item.icon){\n      iconClass = \"icon \" + item.icon\n    }\n\n    let innerHtml = undefined;\n    if (item.htmlElement){\n      innerHtml = createElement('div',{\n          elements: [ item.htmlElement ]\n      })\n    } else {\n      // create item caption\n      innerHtml = createElement('span',{\n        elements :  [ createText(item.name)],\n        className: iconClass\n      })\n    }\n\n    let customClassName = \"\"\n    if (item.className){\n      customClassName = item.className;\n    }\n    if (item.htmlElement){\n      customClassName = customClassName + \" custom-renderer\";\n    }\n    let treeItemHeader = createElement('div',{\n      elements: [ innerHtml ],\n      className: 'header list-item ' + customClassName\n    });\n    treeItemHeader.setAttribute(\"treeitemId\", item.id)\n    treeItemHeader.setAttribute(\"id\", \"de-woekbench-treeview-treeitem-header-\" + item.id)\n    if (item.selected){\n        treeItemHeader.classList.add(\"selected\")\n    }\n\n    treeItemHeader.addEventListener('click',(evt)=>{\n      evt.stopPropagation();\n      this.onItemClicked(evt);\n    })\n\n    treeItemHeader.addEventListener('dblclick',(evt)=>{\n      evt.stopPropagation();\n      this.onItemDblClicked(evt);\n    })\n\n    // create children\n    let childCount = 0;\n    let treeItemChildren = createElement('ol',{\n      className: 'de-workbench-treeview-chidlren-list entries list-tree'\n    })\n    if (item.children){\n      childCount = item.children.length;\n      for (var i=0;i<item.children.length;i++){\n          let child = this.buildTreeItem(item.children[i])\n          insertElement(treeItemChildren, child)\n      }\n    }\n\n    let listClassName = 'list-item';\n    if (childCount>0){\n      listClassName = 'list-nested-item'\n    }\n    if (!item.expanded){\n      listClassName += ' collapsed'\n    }\n    let treeItem = createElement('li',{\n      className : 'de-woekbench-treeview-treeitem entry ' + listClassName ,\n      elements : [ treeItemHeader, treeItemChildren ]\n    })\n    if (item.selected){\n        treeItem.classList.add(\"selected\")\n    }\n    treeItem.setAttribute(\"treeitemId\", item.id)\n    treeItem.setAttribute(\"id\", this.buildItemElementId(item.id))\n\n    if (item.attributes){\n      let attributes = item.attributes;\n      for (var attr=0;attr<attributes.length;attr++){\n        treeItem.setAttribute(attributes[attr].name, attributes[attr].value)\n      }\n    }\n\n    return treeItem;\n  }\n\n  public addEventListener(event:string, listener){\n    this.events.addListener(event, listener)\n  }\n\n  public removeEventListener(event:string, listener){\n    this.events.removeListener(event, listener)\n  }\n\n  protected onItemDblClicked(evt){\n    let itemId = evt.currentTarget.attributes[\"treeitemId\"].value;\n    let item:UITreeItem=null;\n    if(this.model.getItemById){\n      item=this.model.getItemById(itemId);\n    }\n    this.events.emit(\"didItemDblClick\", itemId, item)\n  }\n\n  protected onItemClicked(evt){\n    // Expand/Collapse if necessary\n    let itemId = evt.currentTarget.attributes[\"treeitemId\"].value;\n    this.toggleTreeItemExpansion(itemId);\n\n    // Select the item\n    if (this.currentSelection){\n      // remove current selection\n      this.selectItemById(this.currentSelection, false);\n    }\n    this.selectItemById(itemId, true);\n    this.currentSelection = itemId;\n    this.fireSelectionChange(this.currentSelection);\n  }\n\n  protected fireSelectionChange(itemId:string){\n    let item:UITreeItem=null;\n    if(this.model.getItemById){\n      item=this.model.getItemById(itemId);\n    }\n    this.events.emit(\"didItemSelected\", itemId, item)\n  }\n\n  public getCurrentSelectedItemId():string{\n    return this.currentSelection\n  }\n\n  public selectItemById(id:string,select:boolean){\n    let el = this.mainElement.querySelector('#de-woekbench-treeview-treeitem-header-' + id)\n    if (select){\n\n      el.classList.add(\"selected\");\n      el.parentElement.classList.add(\"selected\");\n    } else {\n      el.classList.remove(\"selected\");\n      el.parentElement.classList.remove(\"selected\");\n    }\n  }\n\n  public buildItemElementId(id:string):string{\n    return \"de-woekbench-treeview-treeitem-li-\" +  id;\n  }\n\n  public expandItemById(id:string){\n    let el = this.getTreeItemById(id);\n    el.classList.remove(\"collapsed\");\n\n    let treeItem = this.model.getItemById(id);\n    treeItem.expanded = true\n\n    this.events.emit(\"didItemExpanded\", id)\n  }\n\n  public collapseItemById(id:string){\n    let el = this.getTreeItemById(id);\n    el.classList.add(\"collapsed\");\n\n    let treeItem = this.model.getItemById(id);\n    treeItem.expanded = false\n\n    this.events.emit(\"didItemCollapsed\", id)\n  }\n\n  public toggleTreeItemExpansion(id:string){\n    let el = this.getTreeItemById(id);\n    el.classList.toggle(\"collapsed\");\n\n    let treeItem = this.model.getItemById(id);\n\n    if (el.classList.contains(\"collapsed\")){\n      this.events.emit(\"didItemCollapsed\", id)\n      treeItem.expanded = false\n    } else {\n      this.events.emit(\"didItemExpanded\", id)\n      treeItem.expanded = true\n    }\n\n\n  }\n\n  public getTreeItemById(id:string){\n    let itemElementId = this.buildItemElementId(id);\n    return this.mainElement.querySelector(\"#\"+itemElementId);\n  }\n\n  public destroy(){\n    this.events.removeAllListeners();\n    this.model = undefined;\n    if (this.treeElement){\n      this.treeElement.remove()\n    }\n    this.events = null;\n    super.destroy();\n  }\n}\n\n\nexport function findItemInTreeModel(itemId:string,model:UITreeViewModel){\n    function _findInTreeItem(item:UITreeItem){\n      if(item.id == itemId){\n        return item;\n      }\n      if(!item.children){\n        return null;\n      }\n      for(let i=0;i < item.children.length; i ++){\n        let found = _findInTreeItem(item.children[i]);\n        if(found){\n          return found;\n        }\n      }\n    }\n\n    return _findInTreeItem(model.root);\n}\n"]}