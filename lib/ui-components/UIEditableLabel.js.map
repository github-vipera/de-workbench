{"version":3,"file":"UIEditableLabel.js","sourceRoot":"","sources":["../../src/ui-components/UIEditableLabel.ts"],"names":[],"mappings":"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","sourcesContent":["'use babel'\nimport {\n  createText,\n  createElement,\n  insertElement,\n  createGroupButtons,\n  createButton,\n  createIcon,\n  createIconFromPath,\n  attachEventFromObject,\n  createTextEditor,\n  createSelect,\n  createOption\n} from '../element/index';\n\nimport { UIComponent, UIBaseComponent, UIExtComponent } from '../ui-components/UIComponent'\n\nconst $ = require('jquery')\n\nexport interface UIEditableLabelOptions {\n    caption?:string;\n    className?:string;\n    editable?:boolean;\n}\n\nexport class UIEditableLabel extends UIExtComponent {\n\n  _options:UIEditableLabelOptions;\n  _labelContainer:HTMLElement;\n  _labelEl:HTMLElement;\n  _editable:boolean=true;\n  _editorEl:HTMLElement;\n  _isEditing:boolean;\n\n  constructor(options?:UIEditableLabelOptions){\n    super();\n    if (options){\n      this._options = options;\n    }\n    if (this._options && (typeof this._options.editable !== 'undefined')){\n      this._editable = this._options.editable;\n    }\n    this.initUI();\n  }\n\n  protected initUI(){\n    this._editorEl = this.createEditor();\n\n    let caption = '';\n    if (this._options && this._options.caption){\n      caption = this._options.caption\n    }\n\n    let className = 'de-workbench-ui-editable-label'\n    // CSS Class\n    if (this._options && this._options.className){\n       className =  className + ' ' + this._options.className\n    }\n    this._labelEl = createElement('a',{\n      elements: [createText(caption)],\n      className: className\n    })\n\n\n    // Events\n    this._labelEl.addEventListener('dblclick',(evt)=>{\n      this.onLabelDoubleClick(evt);\n    })\n\n    this._labelContainer = createElement('div',{\n      elements: [this._labelEl, this._editorEl]\n    })\n\n    this.mainElement = this._labelContainer;\n  }\n\n  public setCaption(caption:string):UIEditableLabel {\n      this._labelEl.innerText = caption\n      return this;\n  }\n\n  protected onLabelDoubleClick(evt){\n    if (this._editable){\n      this.startEditing(this._labelEl);\n    }\n  }\n\n  public startEdit(){\n    if (this._editable){\n      this.startEditing(this._labelEl);\n    }\n  }\n\n  protected createEditor():HTMLElement{\n    //let editorEl = createTextEditor({});\n    let editorEl = createElement('input',{})\n    editorEl.style.background = \"transparent\"\n    editorEl.style.position = \"absolute\"\n    editorEl.style.visibility = \"hidden\"\n    editorEl.classList.add(\"de-workbench-editable-label-editor\");\n    editorEl.classList.add(\"native-key-bindings\")\n    editorEl.addEventListener('keydown',(evt)=>{\n      if (evt.keyCode===13){ //ENTER\n        this.commitEditing();\n      }\n      if (evt.keyCode===27){ //ESC\n        this.cancelEditing();\n      }\n    })\n    return editorEl;\n  }\n\n  protected commitEditing():boolean{\n    console.log('commit!')\n    let value = this._editorEl[\"value\"];\n    this.setCaption(value)\n    this._labelEl.style.visibility = \"visible\"\n    this._editorEl.style.visibility = \"hidden\"\n    $(this._editorEl).off('focusout')\n    $(this._editorEl).off('keydown')\n    this._isEditing = false\n    this.fireEvent('didValueChange', this)\n    return true;\n  }\n\n  protected cancelEditing(){\n    console.log('cancel!')\n    this._labelEl.style.visibility = \"visible\"\n    this._editorEl.style.visibility = \"hidden\"\n    $(this._editorEl).off('focusout')\n    $(this._editorEl).off('keydown')\n    this._isEditing = false\n  }\n\n  protected startEditing(cell:HTMLElement){\n    this.prepareEditor(cell)\n    this._editorEl.style.visibility = \"visible\"\n    this._labelEl.style.visibility = \"hidden\"\n    this._editorEl.focus()\n    this._isEditing = true\n    $(this._editorEl).focusout(()=>{\n      this.commitEditing();\n    })\n  }\n\n  protected prepareEditor(cell:HTMLElement){\n      this.moveEditor(cell);\n\n      let fontSizeCSS = window.getComputedStyle(this._labelEl).getPropertyValue('font-size');\n      this._editorEl.style.setProperty (\"font-size\", fontSizeCSS, \"important\");\n\n      let fontCSS = window.getComputedStyle(this._labelEl).getPropertyValue('font');\n      this._editorEl.style.setProperty (\"font\", fontCSS, \"important\");\n\n      this._editorEl[\"value\"] = cell.innerText;\n      this._editorEl[\"setSelectionRange\"](0, cell.innerText.length)\n\n          $(this._editorEl).keydown(function(e) {\n\n              this.style.width = 0;\n              var newWidth = this.scrollWidth + 10;\n\n              if( this.scrollWidth >= this.clientWidth )\n                  newWidth += 10;\n\n              this.style.width = newWidth + 'px';\n\n          });\n      return this._editorEl;\n  }\n\n  public isEditing():boolean {\n    return this._isEditing;\n  }\n\n  protected moveEditor(cell:HTMLElement){\n    let width = cell.offsetWidth;\n    let height = cell.offsetHeight;\n    this._editorEl.style.width = width + \"px\"\n    this._editorEl.style.height = height +\"px\"\n\n    let offset = $(cell).offset()\n    offset.top += 0\n    offset.left += 0\n    $(this._editorEl).offset(offset)\n\n  }\n\n  public getCaption():string {\n    return this._labelEl.innerText;\n  }\n\n}\n"]}